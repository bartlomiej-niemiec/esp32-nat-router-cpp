// SPDX-FileCopyrightText: 2024 Cesanta Software Limited
// SPDX-License-Identifier: GPL-2.0-only or commercial
// Generated by Mongoose Wizard, https://mongoose.ws/wizard/

// Default mock implementation of the API callbacks

#include "mongoose_glue.h"

// Authenticate user/password. Return access level for the authenticated user:
//   0 - authentication error
//   1,2,3... - authentication success. Higher levels are more privileged than lower
int glue_authenticate(const char *user, const char *pass) {
  int level = 0; // Authentication failure
  if (strcmp(user, "admin") == 0 && strcmp(pass, "admin") == 0) {
    level = 7;  // Administrator
  } else if (strcmp(user, "user") == 0 && strcmp(pass, "user") == 0) {
    level = 3;  // Ordinary dude
  }
  return level;
}

static uint64_t s_action_timeout_applynetworkconfig;  // Time when applynetworkconfig ends
bool glue_check_applynetworkconfig(void) {
  return s_action_timeout_applynetworkconfig > mg_now(); // Return true if applynetworkconfig is in progress
}
void glue_start_applynetworkconfig(struct mg_str params) {
  MG_DEBUG(("Passed parameters: [%.*s]", params.len, params.buf));
  s_action_timeout_applynetworkconfig = mg_now() + 1000; // Start applynetworkconfig, finish after 1 second
}

static struct login s_login = {"", "admin"};
void glue_get_login(struct login *data) {
  *data = s_login;  // Sync with your device
}
void glue_set_login(struct login *data) {
  s_login = *data; // Sync with your device
}

static struct saveapsettings s_saveapsettings = {"255.255.255.0", "192.168.50.1", "", ""};
void glue_get_saveapsettings(struct saveapsettings *data) {
  *data = s_saveapsettings;  // Sync with your device
}
void glue_set_saveapsettings(struct saveapsettings *data) {
  s_saveapsettings = *data; // Sync with your device
}

static struct savestasettings s_savestasettings = {"", "", 42};
void glue_get_savestasettings(struct savestasettings *data) {
  *data = s_savestasettings;  // Sync with your device
}
void glue_set_savestasettings(struct savestasettings *data) {
  s_savestasettings = *data; // Sync with your device
}

static struct stanetworks s_stanetworks = {"", 0, 0, "", "", 0, 0, "", "", 0, 0, "", 0, "", 0, 0, "", "", 0, 0, "", "", 0, 0, "", "", 0, 0, "", "", 0, 0, ""};
void glue_get_stanetworks(struct stanetworks *data) {
  *data = s_stanetworks;  // Sync with your device
}

static uint64_t s_action_timeout_setsta;  // Time when setsta ends
bool glue_check_setsta(void) {
  return s_action_timeout_setsta > mg_now(); // Return true if setsta is in progress
}
void glue_start_setsta(struct mg_str params) {
  MG_DEBUG(("Passed parameters: [%.*s]", params.len, params.buf));
  s_action_timeout_setsta = mg_now() + 1000; // Start setsta, finish after 1 second
}

static struct info s_info = {0, false, false, "Init", "DEF_STA", "DEF_AP"};
void glue_get_info(struct info *data) {
  *data = s_info;  // Sync with your device
}
void glue_set_info(struct info *data) {
  s_info = *data; // Sync with your device
}

static uint64_t s_action_timeout_scannetworks;  // Time when scannetworks ends
bool glue_check_scannetworks(void) {
  return s_action_timeout_scannetworks > mg_now(); // Return true if scannetworks is in progress
}
void glue_start_scannetworks(struct mg_str params) {
  MG_DEBUG(("Passed parameters: [%.*s]", params.len, params.buf));
  s_action_timeout_scannetworks = mg_now() + 1000; // Start scannetworks, finish after 1 second
}


static uint64_t s_action_timeout_save_event;  // Time when save_event ends
bool glue_check_save_event(void) {
  return s_action_timeout_save_event > mg_now(); // Return true if save_event is in progress
}
void glue_start_save_event(struct mg_str params) {
  MG_DEBUG(("Passed parameters: [%.*s]", params.len, params.buf));
  s_action_timeout_save_event = mg_now() + 1000; // Start save_event, finish after 1 second
}

static struct proto_stats_ip s_proto_stats_ip = {0, 0, 0, 0, 0, 0};
void glue_get_proto_stats_ip(struct proto_stats_ip *data) {
  *data = s_proto_stats_ip;  // Sync with your device
}
void glue_set_proto_stats_ip(struct proto_stats_ip *data) {
  s_proto_stats_ip = *data; // Sync with your device
}

static struct proto_stats_tcp s_proto_stats_tcp = {0, 0, 0, 0, 0, 0};
void glue_get_proto_stats_tcp(struct proto_stats_tcp *data) {
  *data = s_proto_stats_tcp;  // Sync with your device
}
void glue_set_proto_stats_tcp(struct proto_stats_tcp *data) {
  s_proto_stats_tcp = *data; // Sync with your device
}

static struct proto_stats_udp s_proto_stats_udp = {0, 0, 0, 0, 0, 0};
void glue_get_proto_stats_udp(struct proto_stats_udp *data) {
  *data = s_proto_stats_udp;  // Sync with your device
}
void glue_set_proto_stats_udp(struct proto_stats_udp *data) {
  s_proto_stats_udp = *data; // Sync with your device
}

static struct proto_stats_icmp s_proto_stats_icmp = {0, 0, 0, 0, 0, 0};
void glue_get_proto_stats_icmp(struct proto_stats_icmp *data) {
  *data = s_proto_stats_icmp;  // Sync with your device
}
void glue_set_proto_stats_icmp(struct proto_stats_icmp *data) {
  s_proto_stats_icmp = *data; // Sync with your device
}

static struct napt_stats s_napt_stats = {0, 0, 0, 0};
void glue_get_napt_stats(struct napt_stats *data) {
  *data = s_napt_stats;  // Sync with your device
}
void glue_set_napt_stats(struct napt_stats *data) {
  s_napt_stats = *data; // Sync with your device
}

void glue_reply_events(struct mg_connection *c, struct mg_http_message *hm) {
  const char *headers = "Cache-Control: no-cache\r\n" "Content-Type: application/json\r\n";
  const char *value = "[{\"id\":0,\"timestamp\":12345,\"message\":\"Something failed\",\"priority\":2,\"status\":\"active\",\"notes\":\"some notes\"},{\"id\":1,\"timestamp\":12395,\"message\":\"Something succeeded\",\"priority\":1,\"status\":\"processed\",\"notes\":\"\"}]";
  (void) hm;
  mg_http_reply(c, 200, headers, "%s\n", value);
}